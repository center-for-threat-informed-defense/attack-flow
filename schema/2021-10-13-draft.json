{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://mitre-engenuity.com/schema/attack-flow/2021-10-13-draft.json",
    "title": "Attack Flow",
    "description": "This schema describes the Attack Flow JSON format.",
    "type": "object",
    "properties": {
        "flow": {
            "description": "An Attack Flow Meta object",
            "type": "object",
            "properties": {
                "type": {
                    "description": "Indicate that this is an Attack Flow.",
                    "type": "string",
                    "enum": ["attack-flow"]
                },
                "id": {
                    "description": "The identifier for this Attack Flow. MUST be unique within this document. TODO: Ideally is unique among Attack Flows produced by a particular organization.",
                    "type": "string",
                    "format": "uuid"
                },
                "name": {
                    "description": "The name of the Attack Flow.",
                    "type": "string"
                },
                "created": {
                    "description": "Creation time of the Attack Flow.",
                    "type": "string",
                    "format": "date-time"
                },
                "author": {
                    "description": "The author of the Attack Flow.",
                    "type": "string"
                },
                "description": {
                    "description": "The description of the Attack Flow.",
                    "type": "string"
                }
            },
            "required": [
                "type",
                "id",
                "name",
                "created"
            ]
        },
        "actions": {
            "description": "The list of action nodes in the attack flow",
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "id": {
                        "description": "The identifier for this Action. MUST be unique within this document.",
                        "type": "string",
                        "format": "uuid"
                    },
                    "name": {
                        "description": "The name of the action. May be an ATT&CK technique name.",
                        "type": "string"
                    },
                    "description": {
                        "description": "A description of the action.",
                        "type": "string"
                    },
                    "timestamp": {
                        "description": "The timestamp when this action was observed.",
                        "type": "string",
                        "format": "date-time"
                    },
                    "reference": {
                        "description": "A reference for the action. May be a URL to an ATT&CK technique.",
                        "type": "string"
                    },
                    "properties": {
                        "description": "The list of properties associated with this action object.",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "succeeded": {
                        "description": "Float from 0 (failed) to 1 (succeeded) or distribution representing the probability that action succeeded in its effects. Any effects which may be separable should be defined through a separate action. Assumed to be 1 (100% ~ TRUE) if not included.",
                        "type": "number"
                    },
                    "confidence": {
                        "description": "Float from 0 to 1 or distribution representing the confidence that the action succeeded. Assumed to be 1 (100% ~ ground truth) if not included.",
                        "type": "number"
                    },
                    "logic_operator_language": {
                        "description": "The language of the logic_operator. Defaults to flow-vTBD when left blank.",
                        "type": "string"
                    },
                    "logic_operator": {
                        "description": "The logic_operator may be any logic valid in the language defined by the logic_operator_language. If the logic_operator_language is undefined, the logic_operator may be AND or OR, representing the relative operation on all required-by relationships. The logic_operator must return the state changes to the provides relationships.",
                        "type": "string",
                        "default": "AND"
                    }
                },
                "required": ["id", "name", "description", "logic_operator"]
            }
        },
        "assets": {
            "description": "The list of asset nodes in the attack flow",
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "id": {
                        "description": "The identifier for this Asset. MUST be unique within this document.",
                        "type": "string",
                        "format": "uuid"
                    },
                    "state": {
                        "description": "A property that may be used as a transient string representing the state of the object during a point in time representing the current state of the system. The sum of all object states is the state of the system. This may be as simple as \"compromised\", the Confidentiality, Integrity, Availability triad, DIMFUI (Degradation, Interruption, Modification, Fabrication, Unauthorized Use, and Interception), or it may even be an arbitrary string. If not included, it is assumed that the state is 'compromised' after a parent action succeeds.",
                        "type": "string"
                    },
                    "properties": {
                        "description": "The list of properties associated with the asset.",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                },
                "required": ["id"]
            }
        },
        "relationships": {
            "description": "The list of relationship edges in the attack flow",
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "id": {
                        "description": "The identifier for this Relationship or Patter. MUST be unique within this document.",
                        "type": "string",
                        "format": "uuid"
                    },
                    "label": {
                        "description": "The type of relationship, e.g. 'modifies'.",
                        "type": "string"
                    },
                    "source": {
                        "description": "The source Action ID or Asset ID for this relationship.",
                        "type": "string",
                        "format": "uuid"
                    },
                    "destination": {
                        "description": "The destination Asset ID or Action ID for this relationship. If the source is an Action, this MUST be an Asset. If the source is an Asset, this MUST be an Action.",
                        "type": "string",
                        "format": "uuid"
                    }
                },
                "required": ["id", "label", "source", "destination"]
            }
        }
    },
    "additionalProperties": true,
    "required": [
        "meta"
    ]
}
