{
    "$schema": "../schema/attack-flow-2022-01-05-draft.json",
    "flow": {
        "type": "attack-flow",
        "id": "https://unit42.paloaltonetworks.com/mac-malware-steals-cryptocurrency-exchanges-cookies/",
        "name": "Mac Malware Steals Cryptocurrency Exchanges Cookies",
        "author": "Eric Kannampuzha",
        "created": "2022-01-28T19:05:51-08:00"
    },
    "actions": [
        {
            "id": "http://flow-1/action-1",
            "type": "action",
            "name": "Command and Scripting Interpreter: Unix Shell",
            "description": "A shell script is executed to copy Safari browser's cookies and upload them to a remote service.",
            "reference": "https://attack.mitre.org/techniques/T1059/004/",
            "succeeded": 0,
            "confidence": 0,
            "logic_operator_language": "",
            "logic_operator": "AND"
        },
        {
            "id": "http://flow-1/action-2",
            "type": "action",
            "name": "Command and Scripting Interpreter: Python",
            "description": "A python script named \"harmlesslittlecode.py\" is run to extract saved login credentials and credit card information from Google Chrome.",
            "reference": "https://attack.mitre.org/techniques/T1059/006/",
            "succeeded": 0,
            "confidence": 0,
            "logic_operator_language": "",
            "logic_operator": "AND"
        },
        {
            "id": "http://flow-1/action-3",
            "type": "action",
            "name": "Resource Hijacking",
            "description": "The xmrig2 Mach-O executable is launched to mine cryptocurrency",
            "reference": "https://attack.mitre.org/techniques/T1496/",
            "succeeded": 0,
            "confidence": 0,
            "logic_operator_language": "",
            "logic_operator": "AND"
        },
        {
            "id": "http://flow-1/action-4",
            "type": "action",
            "name": "Ingress Tool Transfer",
            "description": "A base64 encoded version of the EmPyre post-exploitation Python script is downloaded.",
            "reference": "https://attack.mitre.org/techniques/T1105/",
            "succeeded": 0,
            "confidence": 0,
            "logic_operator_language": "",
            "logic_operator": "AND"
        },
        {
            "id": "http://flow-1/action-5",
            "type": "action",
            "name": "Software Discovery: Security Software Discovery",
            "description": "The EmPyre agent checks if Little Snitch is running on the victim's host.",
            "reference": "https://attack.mitre.org/techniques/T1518/001/",
            "succeeded": 0,
            "confidence": 0,
            "logic_operator_language": "",
            "logic_operator": "AND"
        }
    ],
    "assets": [
        {
            "id": "http://flow-1/asset-6",
            "type": "asset",
            "state": "Credit Card Information"
        },
        {
            "id": "http://flow-1/asset-7",
            "type": "asset",
            "state": "Credentials"
        },
        {
            "id": "http://flow-1/asset-8",
            "type": "asset",
            "state": "Cryptocurrency Wallet Private Keys"
        },
        {
            "id": "http://flow-1/asset-9",
            "type": "asset",
            "state": "SMSFILE"
        },
        {
            "id": "http://flow-1/asset-10",
            "type": "asset",
            "state": "Browser Cookies"
        },
        {
            "id": "http://flow-1/asset-11",
            "type": "asset",
            "state": "EmPyre Agent"
        },
        {
            "id": "http://flow-1/asset-12",
            "type": "asset",
            "state": "Cryptocurrency"
        }
    ],
    "relationships": [
        {
            "source": "http://flow-1/action-1",
            "type": "http://flow-1#provides",
            "target": "http://flow-1/asset-10"
        },
        {
            "source": "http://flow-1/action-2",
            "type": "http://flow-1#provides",
            "target": "http://flow-1/asset-6"
        },
        {
            "source": "http://flow-1/action-2",
            "type": "http://flow-1#provides",
            "target": "http://flow-1/asset-7"
        },
        {
            "source": "http://flow-1/action-2",
            "type": "http://flow-1#provides",
            "target": "http://flow-1/asset-8"
        },
        {
            "source": "http://flow-1/action-2",
            "type": "http://flow-1#provides",
            "target": "http://flow-1/asset-9"
        },
        {
            "source": "http://flow-1/action-4",
            "type": "http://flow-1#Provides",
            "target": "http://flow-1/asset-11"
        },
        {
            "source": "http://flow-1/asset-11",
            "type": "http://flow-1#required-by",
            "target": "http://flow-1/action-5"
        },
        {
            "source": "http://flow-1/action-3",
            "type": "http://flow-1#provides",
            "target": "http://flow-1/asset-12"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/action-1"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/action-2"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/action-3"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/action-4"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/action-5"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/asset-6"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/asset-7"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/asset-8"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/asset-9"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/asset-10"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/asset-11"
        },
        {
            "source": "http://flow-1",
            "type": "http://flow-1#flow-edge",
            "target": "http://flow-1/asset-12"
        }
    ],
    "object_properties": [],
    "data_properties": [
        {
            "source": "http://flow-1/asset-11",
            "type": "http://flow-1#state",
            "target": "Base64 Encoded"
        }
    ]
}